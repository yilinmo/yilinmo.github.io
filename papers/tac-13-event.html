---
layout: page
title: Stochastic Event-triggered Sensor Schedule for Remote State Estimation
---
<hr  />
<p>
<b>Duo Han, Yilin Mo, Junfeng Wu, Sean Weerakkody, Bruno Sinopoli and Ling Shi</b>
</p>

<p>
<i>IEEE Transactions on Automatic Control</i>, To be appeared
</p>

<p>
Link to the <a href="../../../public/papers/tac-13-event.pdf">paper</a>
</p>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">Abstract</h2>
<div class="outline-text-2" id="text-1">
<p>
We propose an open-loop and a closed-loop stochastic event-triggered sensor schedule for remote state estimation. Both schedules overcome the essential difficulties of existing schedules in recent literature works where, through introducing a deterministic event-triggering mechanism, the Gaussian property of the innovation process is destroyed which produces a challenging nonlinear filtering problem that cannot be solved unless approximation techniques are adopted. The proposed stochastic event-triggered sensor schedules eliminate such approximations. Under these two schedules, the minimum mean squared error (MMSE) estimator and its estimation error covariance matrix at the remote estimator are given in a closed-form. The stability in terms of the expected error covariance and the sample path of the error covariance for both schedules is studied. We also formulate and solve an optimization problem to obtain the minimum communication rate under some estimation quality constraint using the open-loop sensor schedule. A numerical comparison between the closed-loop MMSE estimator and a typical approximate MMSE estimator with deterministic event-triggered sensor schedule, in a problem setting of target tracking, shows the superiority of the proposed sensor schedule.
</p>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">Simulation Code</h2>
<div class="outline-text-2" id="text-2">
<p>
The code is written in Matlab R2009b (7.9.0.529) with the following dependency
</p>
<ul class="org-ul">
<li>CVX Version 2.1, Build 1085 (9a166a6) 
</li>
</ul>
</div>
<div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1">Fig 2</h3>
<div class="outline-text-3" id="text-2-1">
<div class="org-src-container">

<pre class="src src-matlab"><span style="color: #586e75;">%Compare the periodic schedule, the closed-loop schedule, the open loop</span>
<span style="color: #586e75;">%schedule and the random schedule.</span>

close all;
clear all;
clc;

<span style="color: #586e75; font-weight: bold; text-decoration: overline;">%%%% Since there is no close-form relationship between rate and  Z.</span>
<span style="color: #586e75; font-weight: bold; text-decoration: overline;">%%%% we need to find the empirical mapping from rate to Z.</span>

<span style="color: #586e75;">% parameter setting</span>
n = 1;
m = 1;
A = 0.8; <span style="color: #586e75;">% generate a stable A</span>
C = 1;
Q = 1<span style="color: #b58900;">*</span>eye(n);
sqrtQ = sqrtm(Q);
R = 1<span style="color: #b58900;">*</span>eye(m);
sqrtR = sqrtm(R);

N = 40000;
sample = 20; <span style="color: #586e75;">% x-axis data points</span>

Px = dlyap(A,Q);      <span style="color: #586e75;">%asymptotic covariance of x</span>
Py = C <span style="color: #b58900;">*</span> Px <span style="color: #b58900;">*</span> C' <span style="color: #b58900;">+</span> R; <span style="color: #586e75;">%asymptotic covariance of y</span>


Z_data = zeros(1,sample);
Z_data(1)=0.01;
Z_data(2)=0.04;
Z_data(3)=0.09;

<span style="color: #859900; font-weight: bold;">for</span> <span style="color: #268bd2;">i</span>=<span style="color: #268bd2; font-weight: bold;">1:sample</span>
    Z_data(<span style="color: #268bd2; font-weight: bold;">i</span>)=exp(0.1<span style="color: #b58900;">*</span><span style="color: #268bd2; font-weight: bold;">i</span>)<span style="color: #b58900;">-</span>1; <span style="color: #586e75;">%generates uniform Z data points</span>
<span style="color: #859900; font-weight: bold;">end</span>


<span style="color: #268bd2; font-weight: bold;">j</span>=0;
h = waitbar(0,<span style="color: #2aa198;">'please wait...'</span>);

rate=zeros(1,sample);
close_empiricalrate_data = zeros(1,n);
close_empiricalmse_data = zeros(1,n);
open_empiricalrate_data = zeros(1,n);
open_empiricalmse_data = zeros(1,n);
periodic_empiricalrate_data = zeros(1,n);
periodic_empiricalmse_data = zeros(1,n);
periodic_rate = zeros(1,n);
random_empiricalrate_data = zeros(1,n);
random_empiricalmse_data = zeros(1,n);
jf_empiricalrate_data = zeros(1,n);
jf_empiricalmse_data = zeros(1,n);

<span style="color: #859900; font-weight: bold;">for</span> <span style="color: #268bd2;">i</span>=<span style="color: #268bd2; font-weight: bold;">1:sample</span>

    <span style="color: #586e75;">%timer update</span>
    <span style="color: #268bd2; font-weight: bold;">j</span>=<span style="color: #268bd2; font-weight: bold;">j</span><span style="color: #b58900;">+</span>1;
    waitbar(<span style="color: #268bd2; font-weight: bold;">j</span><span style="color: #b58900;">/</span>sample,h);


    x=zeros(1,N<span style="color: #b58900;">+</span>1);
    Sigma = eye(n);
    x(1) = sqrtm(Sigma)<span style="color: #b58900;">*</span>randn(1,n);

    y=zeros(1,N<span style="color: #b58900;">+</span>1);

    Z = Z_data(<span style="color: #268bd2; font-weight: bold;">i</span>); 
    invZ = 1<span style="color: #b58900;">/</span>Z;


    close_empiricalmse = zeros(n); <span style="color: #586e75;">%average error*error'</span>
    close_mse = zeros(n); <span style="color: #586e75;">%average P_k</span>
    close_empiricalrate = 0; 

    open_empiricalmse = zeros(n); 
    open_mse = zeros(n); 
    open_empiricalrate = 0;

    periodic_empiricalmse = zeros(n); 
    periodic_mse = zeros(n); 

    random_empiricalmse = zeros(n); 
    random_mse = zeros(n); 

    <span style="color: #859900; font-weight: bold;">for</span> <span style="color: #268bd2;">k</span>=<span style="color: #268bd2; font-weight: bold;">1:N  </span><span style="color: #586e75;">%linear dynamic system</span>
        x(k<span style="color: #b58900;">+</span>1) = A <span style="color: #b58900;">*</span> x(k) <span style="color: #b58900;">+</span> sqrtQ <span style="color: #b58900;">*</span> randn(1,n);
        y(k) = C <span style="color: #b58900;">*</span> x(k) <span style="color: #b58900;">+</span> sqrtR <span style="color: #b58900;">*</span> randn(1,m);
    <span style="color: #859900; font-weight: bold;">end</span>

    <span style="color: #586e75; font-weight: bold; text-decoration: overline;">%% closed-loop event-based MMSE under different rate</span>
    hatx = zeros(1,n);
    P = Sigma;

    <span style="color: #859900; font-weight: bold;">for</span> <span style="color: #268bd2;">k</span> = <span style="color: #268bd2; font-weight: bold;">1:N</span>


        <span style="color: #586e75;">%generate a uniform random variable</span>
        zeta = rand();
        threshold = exp(<span style="color: #b58900;">-</span>0.5<span style="color: #b58900;">*</span>(y(k)<span style="color: #b58900;">-</span>C<span style="color: #b58900;">*</span>hatx)'<span style="color: #b58900;">*</span>(Z)<span style="color: #b58900;">*</span>(y(k)<span style="color: #b58900;">-</span>C<span style="color: #b58900;">*</span>hatx));
        <span style="color: #859900; font-weight: bold;">if</span> zeta <span style="color: #b58900;">&lt;</span> threshold <span style="color: #586e75;">% not send y</span>
            F = P <span style="color: #b58900;">*</span> C' <span style="color: #b58900;">/</span> ( C<span style="color: #b58900;">*</span>P<span style="color: #b58900;">*</span>C' <span style="color: #b58900;">+</span> R <span style="color: #b58900;">+</span> invZ);
            hatx = hatx;
            P = P <span style="color: #b58900;">-</span> F<span style="color: #b58900;">*</span>C<span style="color: #b58900;">*</span>P;
        <span style="color: #859900; font-weight: bold;">else</span> <span style="color: #586e75;">% send y</span>
            L = P <span style="color: #b58900;">*</span> C' <span style="color: #b58900;">/</span> ( C<span style="color: #b58900;">*</span>P<span style="color: #b58900;">*</span>C' <span style="color: #b58900;">+</span> R);
            hatx = (eye(n) <span style="color: #b58900;">-</span> L<span style="color: #b58900;">*</span>C)<span style="color: #b58900;">*</span>hatx <span style="color: #b58900;">+</span> L<span style="color: #b58900;">*</span>y(k);
            P = P <span style="color: #b58900;">-</span> L<span style="color: #b58900;">*</span>C<span style="color: #b58900;">*</span>P;
            close_empiricalrate = close_empiricalrate <span style="color: #b58900;">+</span> 1;
        <span style="color: #859900; font-weight: bold;">end</span>
        <span style="color: #586e75;">%prediction step</span>
        hatx = A <span style="color: #b58900;">*</span> hatx; 
        P = A <span style="color: #b58900;">*</span> P <span style="color: #b58900;">*</span> A' <span style="color: #b58900;">+</span> Q;
        close_mse = close_mse <span style="color: #b58900;">+</span> P;
        close_error = x(k) <span style="color: #b58900;">-</span> hatx;
        close_empiricalmse = close_empiricalmse <span style="color: #b58900;">+</span> close_error <span style="color: #b58900;">*</span> close_error';
    <span style="color: #859900; font-weight: bold;">end</span>

    close_mse_data(<span style="color: #268bd2; font-weight: bold;">i</span>)=close_mse <span style="color: #b58900;">/</span> N;
    close_empiricalmse_data(<span style="color: #268bd2; font-weight: bold;">i</span>) = close_empiricalmse <span style="color: #b58900;">/</span> N;
    close_empiricalrate_data(<span style="color: #268bd2; font-weight: bold;">i</span>) = close_empiricalrate <span style="color: #b58900;">/</span> N;

    <span style="color: #586e75; font-weight: bold; text-decoration: overline;">%% open-loop event-based MMSE under different rate</span>

    Y = ((1<span style="color: #b58900;">/</span>(1<span style="color: #b58900;">-</span>close_empiricalrate_data(<span style="color: #268bd2; font-weight: bold;">i</span>)))<span style="color: #b58900;">^</span>2<span style="color: #b58900;">-</span>1)<span style="color: #b58900;">/</span>Py; <span style="color: #586e75;">% compute Y according to the empirical rate in the closed-loop case</span>

    hatx = zeros(1,n);
    P = Sigma;

    <span style="color: #859900; font-weight: bold;">for</span> <span style="color: #268bd2;">k</span> = <span style="color: #268bd2; font-weight: bold;">1:N</span>
        <span style="color: #586e75;">%prediction step</span>

        <span style="color: #586e75;">%uniform random variable</span>
        zeta = rand();
        threshold = exp(<span style="color: #b58900;">-</span>0.5<span style="color: #b58900;">*</span>y(k)'<span style="color: #b58900;">*</span>Y<span style="color: #b58900;">*</span>y(k));
        <span style="color: #859900; font-weight: bold;">if</span> zeta <span style="color: #b58900;">&lt;</span> threshold <span style="color: #586e75;">% not send y</span>
            L = P <span style="color: #b58900;">*</span> C' <span style="color: #b58900;">/</span> ( C<span style="color: #b58900;">*</span>P<span style="color: #b58900;">*</span>C' <span style="color: #b58900;">+</span> R <span style="color: #b58900;">+</span> 1<span style="color: #b58900;">/</span>Y);
            hatx = (eye(n) <span style="color: #b58900;">-</span> L<span style="color: #b58900;">*</span>C)<span style="color: #b58900;">*</span>hatx;
            P = P <span style="color: #b58900;">-</span> L<span style="color: #b58900;">*</span>C<span style="color: #b58900;">*</span>P;
        <span style="color: #859900; font-weight: bold;">else</span> <span style="color: #586e75;">% send y</span>
            L = P <span style="color: #b58900;">*</span> C' <span style="color: #b58900;">/</span> ( C<span style="color: #b58900;">*</span>P<span style="color: #b58900;">*</span>C' <span style="color: #b58900;">+</span> R);
            hatx = (eye(n) <span style="color: #b58900;">-</span> L<span style="color: #b58900;">*</span>C)<span style="color: #b58900;">*</span>hatx <span style="color: #b58900;">+</span> L<span style="color: #b58900;">*</span>y(k);
            P = P <span style="color: #b58900;">-</span> L<span style="color: #b58900;">*</span>C<span style="color: #b58900;">*</span>P;
        <span style="color: #859900; font-weight: bold;">end</span>
        hatx = A <span style="color: #b58900;">*</span> hatx; 
        P = A <span style="color: #b58900;">*</span> P <span style="color: #b58900;">*</span> A' <span style="color: #b58900;">+</span> Q;
        open_mse = open_mse <span style="color: #b58900;">+</span> P;
        open_error = x(k) <span style="color: #b58900;">-</span> hatx;
        open_empiricalmse = open_empiricalmse <span style="color: #b58900;">+</span> open_error <span style="color: #b58900;">*</span> open_error';
    <span style="color: #859900; font-weight: bold;">end</span>

    open_mse_data(<span style="color: #268bd2; font-weight: bold;">i</span>)=open_mse <span style="color: #b58900;">/</span> N;
    open_empiricalmse_data(<span style="color: #268bd2; font-weight: bold;">i</span>) = open_empiricalmse <span style="color: #b58900;">/</span> N;

    <span style="color: #586e75; font-weight: bold; text-decoration: overline;">%% periodic offline MMSE under different rate   </span>
    hatx = zeros(1,n);
    P = Sigma;

    <span style="color: #859900; font-weight: bold;">if</span> <span style="color: #268bd2; font-weight: bold;">i</span><span style="color: #b58900;">&lt;</span>sample<span style="color: #b58900;">/</span>2
        <span style="color: #859900; font-weight: bold;">for</span> <span style="color: #268bd2;">a</span>=<span style="color: #268bd2; font-weight: bold;">1:N</span>
            <span style="color: #859900; font-weight: bold;">if</span> mod(a,<span style="color: #268bd2; font-weight: bold;">i</span><span style="color: #b58900;">+</span>1)<span style="color: #b58900;">==</span>1 <span style="color: #586e75;">% send y</span>
                L = P <span style="color: #b58900;">*</span> C' <span style="color: #b58900;">/</span> ( C<span style="color: #b58900;">*</span>P<span style="color: #b58900;">*</span>C' <span style="color: #b58900;">+</span> R);
                hatx = (1 <span style="color: #b58900;">-</span> L<span style="color: #b58900;">*</span>C)<span style="color: #b58900;">*</span>hatx <span style="color: #b58900;">+</span> L<span style="color: #b58900;">*</span>y(a);
                P = P <span style="color: #b58900;">-</span> L<span style="color: #b58900;">*</span>C<span style="color: #b58900;">*</span>P;
            <span style="color: #859900; font-weight: bold;">else</span> <span style="color: #586e75;">% not send y</span>
                hatx = hatx;
                P = P;
            <span style="color: #859900; font-weight: bold;">end</span>
            hatx = A <span style="color: #b58900;">*</span> hatx; 
            P = A <span style="color: #b58900;">*</span> P <span style="color: #b58900;">*</span> A' <span style="color: #b58900;">+</span> Q;
            periodic_mse = periodic_mse <span style="color: #b58900;">+</span> P;
        <span style="color: #859900; font-weight: bold;">end</span>
    <span style="color: #859900; font-weight: bold;">else</span>
        <span style="color: #859900; font-weight: bold;">for</span> <span style="color: #268bd2;">a</span>=<span style="color: #268bd2; font-weight: bold;">1:N</span>

            <span style="color: #859900; font-weight: bold;">if</span> mod(a,<span style="color: #268bd2; font-weight: bold;">i</span><span style="color: #b58900;">-</span>sample<span style="color: #b58900;">/</span>2<span style="color: #b58900;">+</span>3)<span style="color: #b58900;">==</span>1 <span style="color: #586e75;">% not send y</span>
                hatx = hatx;
                P = P;  
            <span style="color: #859900; font-weight: bold;">else</span> <span style="color: #586e75;">% send y</span>
                L = P <span style="color: #b58900;">*</span> C' <span style="color: #b58900;">/</span> ( C<span style="color: #b58900;">*</span>P<span style="color: #b58900;">*</span>C' <span style="color: #b58900;">+</span> R);
                hatx = (1 <span style="color: #b58900;">-</span> L<span style="color: #b58900;">*</span>C)<span style="color: #b58900;">*</span>hatx <span style="color: #b58900;">+</span> L<span style="color: #b58900;">*</span>y(a);
                P = P <span style="color: #b58900;">-</span> L<span style="color: #b58900;">*</span>C<span style="color: #b58900;">*</span>P;
            <span style="color: #859900; font-weight: bold;">end</span>
            hatx = A <span style="color: #b58900;">*</span> hatx; 
            P = A <span style="color: #b58900;">*</span> P <span style="color: #b58900;">*</span> A' <span style="color: #b58900;">+</span> Q;
            periodic_mse = periodic_mse <span style="color: #b58900;">+</span> P;
        <span style="color: #859900; font-weight: bold;">end</span> 
    <span style="color: #859900; font-weight: bold;">end</span>
    <span style="color: #859900; font-weight: bold;">if</span> <span style="color: #268bd2; font-weight: bold;">i</span><span style="color: #b58900;">&lt;</span>sample<span style="color: #b58900;">/</span>2
        periodic_rate(sample<span style="color: #b58900;">/</span>2<span style="color: #b58900;">-</span><span style="color: #268bd2; font-weight: bold;">i</span>)=1<span style="color: #b58900;">/</span>(<span style="color: #268bd2; font-weight: bold;">i</span><span style="color: #b58900;">+</span>1); 
        periodic_mse_data(sample<span style="color: #b58900;">/</span>2<span style="color: #b58900;">-</span><span style="color: #268bd2; font-weight: bold;">i</span>)=periodic_mse <span style="color: #b58900;">/</span> N;
    <span style="color: #859900; font-weight: bold;">else</span>
        periodic_rate(<span style="color: #268bd2; font-weight: bold;">i</span>)=1<span style="color: #b58900;">-</span>1<span style="color: #b58900;">/</span>(<span style="color: #268bd2; font-weight: bold;">i</span><span style="color: #b58900;">-</span>sample<span style="color: #b58900;">/</span>2<span style="color: #b58900;">+</span>3);
        periodic_mse_data(<span style="color: #268bd2; font-weight: bold;">i</span>)=periodic_mse <span style="color: #b58900;">/</span> N;
    <span style="color: #859900; font-weight: bold;">end</span>
<span style="color: #859900; font-weight: bold;">end</span>

rate_rand=zeros(1,sample);
rate_rand=[close_empiricalrate_data(1)<span style="color: #b58900;">:</span>(close_empiricalrate_data(sample)<span style="color: #b58900;">-</span>close_empiricalrate_data(1))<span style="color: #b58900;">/</span>19<span style="color: #b58900;">:</span>close_empiricalrate_data(sample)];


<span style="color: #859900; font-weight: bold;">for</span> <span style="color: #268bd2;">i</span>=<span style="color: #268bd2; font-weight: bold;">1:sample</span>
    random_empiricalmse = zeros(n); 
    random_mse = zeros(n); 
    <span style="color: #586e75; font-weight: bold; text-decoration: overline;">%% random offline MMSE under different rate   </span>
    hatx = zeros(1,n);
    P = Sigma;

    <span style="color: #859900; font-weight: bold;">for</span> <span style="color: #268bd2;">k</span> = <span style="color: #268bd2; font-weight: bold;">1:N</span>

        <span style="color: #859900; font-weight: bold;">if</span> zeta <span style="color: #b58900;">&lt;</span> 1<span style="color: #b58900;">-</span>rate_rand(<span style="color: #268bd2; font-weight: bold;">i</span>) <span style="color: #586e75;">% not send y</span>
            hatx = hatx;
            P = P;
        <span style="color: #859900; font-weight: bold;">else</span> <span style="color: #586e75;">% send y</span>
            L = P <span style="color: #b58900;">*</span> C' <span style="color: #b58900;">/</span> ( C<span style="color: #b58900;">*</span>P<span style="color: #b58900;">*</span>C' <span style="color: #b58900;">+</span> R);
            hatx = (eye(n) <span style="color: #b58900;">-</span> L<span style="color: #b58900;">*</span>C)<span style="color: #b58900;">*</span>hatx <span style="color: #b58900;">+</span> L<span style="color: #b58900;">*</span>y(k);
            P = P <span style="color: #b58900;">-</span> L<span style="color: #b58900;">*</span>C<span style="color: #b58900;">*</span>P;
        <span style="color: #859900; font-weight: bold;">end</span>
        <span style="color: #586e75;">%prediction step</span>
        hatx = A <span style="color: #b58900;">*</span> hatx; 
        P = A <span style="color: #b58900;">*</span> P <span style="color: #b58900;">*</span> A' <span style="color: #b58900;">+</span> Q;
        zeta = rand();
        random_mse = random_mse <span style="color: #b58900;">+</span> P;
        random_error = x(k) <span style="color: #b58900;">-</span> hatx;
        random_empiricalmse = random_empiricalmse <span style="color: #b58900;">+</span> random_error <span style="color: #b58900;">*</span> random_error';
    <span style="color: #859900; font-weight: bold;">end</span>

    random_mse_data(<span style="color: #268bd2; font-weight: bold;">i</span>)=random_mse <span style="color: #b58900;">/</span> N;
    random_empiricalmse_data(<span style="color: #268bd2; font-weight: bold;">i</span>) = random_empiricalmse <span style="color: #b58900;">/</span> N;

<span style="color: #859900; font-weight: bold;">end</span>

<span style="color: #586e75; font-weight: bold; text-decoration: overline;">%%% plot the figures</span>
close(h);
<span style="color: #b58900;">figure</span>;
plot(close_empiricalrate_data,close_mse_data,<span style="color: #2aa198;">'LineWidth'</span>,2);
hold on;
plot(close_empiricalrate_data,open_mse_data, <span style="color: #2aa198;">'r--'</span>,<span style="color: #2aa198;">'LineWidth'</span>,2);
hold on;
plot(rate_rand,random_mse_data,<span style="color: #2aa198;">'k-o'</span>,<span style="color: #2aa198;">'LineWidth'</span>,2);
hold on;
plot(periodic_rate(3<span style="color: #b58900;">:</span>sample<span style="color: #b58900;">-</span>9),periodic_mse_data(3<span style="color: #b58900;">:</span>sample<span style="color: #b58900;">-</span>9),<span style="color: #2aa198;">'g-+'</span>,<span style="color: #2aa198;">'LineWidth'</span>,2);
<span style="color: #586e75;">% hold on;</span>
<span style="color: #586e75;">% plot(close_empiricalrate_data,jf_mse_data,'m-*','LineWidth',2);</span>
legend(<span style="color: #2aa198;">'Closed-loop event-based schedule'</span>,<span style="color: #2aa198;">'Open-loop event-based schedule'</span>,<span style="color: #2aa198;">'Random offline schedule'</span>,<span style="color: #2aa198;">'Periodic offline schedule'</span>);
xlabel(<span style="color: #2aa198;">'\gamma'</span>);
ylabel(<span style="color: #2aa198;">'$\lim_{k\rightarrow\infty}\rm E[P_k^-]$'</span>,<span style="color: #2aa198;">'Interpreter'</span>,<span style="color: #2aa198;">'LaTex'</span>);
<span style="color: #586e75;">%ylabel('lim_{k\rightarrow \infty} E[P_k^-]');</span>
grid on;

filename = <span style="color: #2aa198;">'../../../public/tac-13-2.png'</span>;
print(<span style="color: #2aa198;">'-dpng'</span>, filename, <span style="color: #2aa198;">'-r100'</span>);
<span style="color: #268bd2; font-weight: bold;">ans</span> = filename <span style="color: #586e75;">% return the filename to org-mode</span>
</pre>
</div>


<div class="figure">
<p><img src="../../../public/tac-13-2.png" alt="tac-13-2.png" />
</p>
</div>
</div>
</div>
<div id="outline-container-sec-2-2" class="outline-3">
<h3 id="sec-2-2">Fig 3</h3>
<div class="outline-text-3" id="text-2-2">
<div class="org-src-container">

<pre class="src src-matlab"><span style="color: #586e75;">% plot the upper bound, the lower bound and the empirical expected error of</span>
<span style="color: #586e75;">% covariance of the open loop schedule</span>
close all;
clear all;

n = 2;
m = 1;
A = [0.8 1;0 0.95]; <span style="color: #586e75;">% generate a stable A</span>
C = [1 1];
Q = eye(n);
sqrtQ = sqrtm(Q);
R = eye(m);
sqrtR = sqrtm(R);

N = 50000;
sample = 30; <span style="color: #586e75;">% x-axis data points</span>

Px = dlyap(A,Q);      <span style="color: #586e75;">%asymptotic covariance of x</span>
Py = C <span style="color: #b58900;">*</span> Px <span style="color: #b58900;">*</span> C' <span style="color: #b58900;">+</span> R; <span style="color: #586e75;">%asymptotic covariance of y</span>

<span style="color: #268bd2; font-weight: bold;">j</span>=0;
h = waitbar(0,<span style="color: #2aa198;">'please wait...'</span>);

rate=zeros(1,sample);
open_empiricalrate_data = zeros(1,sample);
open_empiricalmse_data = zeros(1,sample);
test_mse_data = zeros(1,sample);
seq = zeros(1,N);

<span style="color: #586e75; font-weight: bold; text-decoration: overline;">%% open-loop event-based MMSE under different rate</span>
<span style="color: #859900; font-weight: bold;">for</span> <span style="color: #268bd2;">i</span>=<span style="color: #268bd2; font-weight: bold;">1:sample</span>
    <span style="color: #268bd2; font-weight: bold;">j</span>=<span style="color: #268bd2; font-weight: bold;">j</span><span style="color: #b58900;">+</span>1;
    waitbar(<span style="color: #268bd2; font-weight: bold;">j</span><span style="color: #b58900;">/</span>sample,h);

    rate(<span style="color: #268bd2; font-weight: bold;">i</span>)=0.001<span style="color: #b58900;">+</span><span style="color: #268bd2; font-weight: bold;">i</span><span style="color: #b58900;">/</span>sample<span style="color: #b58900;">*</span>0.9;

    Y = ((1<span style="color: #b58900;">/</span>(1<span style="color: #b58900;">-</span>rate(<span style="color: #268bd2; font-weight: bold;">i</span>)))<span style="color: #b58900;">^</span>2<span style="color: #b58900;">-</span>1)<span style="color: #b58900;">/</span>Py; <span style="color: #586e75;">% compute Y according to the  rate</span>

    x=zeros(n,N<span style="color: #b58900;">+</span>1);
    Sigma = eye(n);
    x(<span style="color: #b58900;">:</span>,1) = sqrtm(Sigma)<span style="color: #b58900;">*</span>randn(n,1);

    y=zeros(m,N<span style="color: #b58900;">+</span>1);


    open_empiricalmse = zeros(n); <span style="color: #586e75;">%average error*error'</span>
    open_mse = zeros(n); <span style="color: #586e75;">%average P_k</span>
    open_empiricalrate = 0; 
    upper_mse = zeros(n); <span style="color: #586e75;">%average P_k</span>
    lower_mse = zeros(n); <span style="color: #586e75;">%average P_k</span>

    hatx = zeros(n,1);
    P = Sigma;   

       <span style="color: #859900; font-weight: bold;">for</span> <span style="color: #268bd2;">k</span> = <span style="color: #268bd2; font-weight: bold;">1:N</span>
        L = P <span style="color: #b58900;">*</span> C' <span style="color: #b58900;">/</span> ( C<span style="color: #b58900;">*</span>P<span style="color: #b58900;">*</span>C' <span style="color: #b58900;">+</span> R <span style="color: #b58900;">+</span>1<span style="color: #b58900;">/</span>Y);
        hatx = (eye(n) <span style="color: #b58900;">-</span> L<span style="color: #b58900;">*</span>C)<span style="color: #b58900;">*</span>hatx <span style="color: #b58900;">+</span> L<span style="color: #b58900;">*</span>y(<span style="color: #b58900;">:</span>,k);
        P = P <span style="color: #b58900;">-</span> L<span style="color: #b58900;">*</span>C<span style="color: #b58900;">*</span>P;
        <span style="color: #586e75;">%prediction step</span>
        hatx = A <span style="color: #b58900;">*</span> hatx; 
        P = A <span style="color: #b58900;">*</span> P <span style="color: #b58900;">*</span> A' <span style="color: #b58900;">+</span> Q;        
        upper_mse = upper_mse <span style="color: #b58900;">+</span> P;
       <span style="color: #859900; font-weight: bold;">end</span>

    upper_mse_data(<span style="color: #268bd2; font-weight: bold;">i</span>)=trace(upper_mse) <span style="color: #b58900;">/</span> N;

    hatx = zeros(n,1);
    P = Sigma;   

       <span style="color: #859900; font-weight: bold;">for</span> <span style="color: #268bd2;">k</span> = <span style="color: #268bd2; font-weight: bold;">1:N</span>
        L = P <span style="color: #b58900;">*</span> C' <span style="color: #b58900;">/</span> ( C<span style="color: #b58900;">*</span>P<span style="color: #b58900;">*</span>C' <span style="color: #b58900;">+</span> 1<span style="color: #b58900;">/</span>(rate(<span style="color: #268bd2; font-weight: bold;">i</span>)<span style="color: #b58900;">/</span>R <span style="color: #b58900;">+</span> (1<span style="color: #b58900;">-</span>rate(<span style="color: #268bd2; font-weight: bold;">i</span>))<span style="color: #b58900;">/</span>(R<span style="color: #b58900;">+</span>1<span style="color: #b58900;">/</span>Y)) );
        hatx = (eye(n) <span style="color: #b58900;">-</span> L<span style="color: #b58900;">*</span>C)<span style="color: #b58900;">*</span>hatx <span style="color: #b58900;">+</span> L<span style="color: #b58900;">*</span>y(<span style="color: #b58900;">:</span>,k);
        P = P <span style="color: #b58900;">-</span> L<span style="color: #b58900;">*</span>C<span style="color: #b58900;">*</span>P;
        <span style="color: #586e75;">%prediction step</span>
        hatx = A <span style="color: #b58900;">*</span> hatx; 
        P = A <span style="color: #b58900;">*</span> P <span style="color: #b58900;">*</span> A' <span style="color: #b58900;">+</span> Q;        
        lower_mse =lower_mse <span style="color: #b58900;">+</span> P;
       <span style="color: #859900; font-weight: bold;">end</span>

    lower_mse_data(<span style="color: #268bd2; font-weight: bold;">i</span>)=trace(lower_mse) <span style="color: #b58900;">/</span> N;



    hatx = zeros(n,1);
    P = Sigma;

    <span style="color: #859900; font-weight: bold;">for</span> <span style="color: #268bd2;">k</span>=<span style="color: #268bd2; font-weight: bold;">1:N  </span><span style="color: #586e75;">%linear dynamic system</span>
        x(<span style="color: #b58900;">:</span>,k<span style="color: #b58900;">+</span>1) = A <span style="color: #b58900;">*</span> x(<span style="color: #b58900;">:</span>,k) <span style="color: #b58900;">+</span> sqrtQ <span style="color: #b58900;">*</span> randn(n,1);
        y(<span style="color: #b58900;">:</span>,k) = C <span style="color: #b58900;">*</span> x(<span style="color: #b58900;">:</span>,k) <span style="color: #b58900;">+</span> sqrtR <span style="color: #b58900;">*</span> randn(m,1);
    <span style="color: #859900; font-weight: bold;">end</span>

    <span style="color: #859900; font-weight: bold;">for</span> <span style="color: #268bd2;">k</span> = <span style="color: #268bd2; font-weight: bold;">1:N</span>

        <span style="color: #586e75;">%uniform random variable</span>
        zeta = rand();
        threshold = exp(<span style="color: #b58900;">-</span>0.5<span style="color: #b58900;">*</span>y(<span style="color: #b58900;">:</span>,k)'<span style="color: #b58900;">*</span>Y<span style="color: #b58900;">*</span>y(<span style="color: #b58900;">:</span>,k));
        <span style="color: #859900; font-weight: bold;">if</span> zeta <span style="color: #b58900;">&lt;</span> threshold <span style="color: #586e75;">% not send y</span>
            L = P <span style="color: #b58900;">*</span> C' <span style="color: #b58900;">/</span> ( C<span style="color: #b58900;">*</span>P<span style="color: #b58900;">*</span>C' <span style="color: #b58900;">+</span> R <span style="color: #b58900;">+</span> 1<span style="color: #b58900;">/</span>Y);
            hatx = (eye(n) <span style="color: #b58900;">-</span> L<span style="color: #b58900;">*</span>C)<span style="color: #b58900;">*</span>hatx;
            P = P <span style="color: #b58900;">-</span> L<span style="color: #b58900;">*</span>C<span style="color: #b58900;">*</span>P;
            seq(k) = 0;
        <span style="color: #859900; font-weight: bold;">else</span> <span style="color: #586e75;">% send y</span>
            L = P <span style="color: #b58900;">*</span> C' <span style="color: #b58900;">/</span> ( C<span style="color: #b58900;">*</span>P<span style="color: #b58900;">*</span>C' <span style="color: #b58900;">+</span> R);
            hatx = (eye(n) <span style="color: #b58900;">-</span> L<span style="color: #b58900;">*</span>C)<span style="color: #b58900;">*</span>hatx <span style="color: #b58900;">+</span> L<span style="color: #b58900;">*</span>y(<span style="color: #b58900;">:</span>,k);
            P = P <span style="color: #b58900;">-</span> L<span style="color: #b58900;">*</span>C<span style="color: #b58900;">*</span>P;
            seq(k) = 1;
        <span style="color: #859900; font-weight: bold;">end</span>
        <span style="color: #586e75;">%prediction step</span>
        hatx = A <span style="color: #b58900;">*</span> hatx; 
        P = A <span style="color: #b58900;">*</span> P <span style="color: #b58900;">*</span> A' <span style="color: #b58900;">+</span> Q;
        open_mse = open_mse <span style="color: #b58900;">+</span> P;
        open_error = x(<span style="color: #b58900;">:</span>,k) <span style="color: #b58900;">-</span> hatx;
        open_empiricalmse = open_empiricalmse <span style="color: #b58900;">+</span> open_error <span style="color: #b58900;">*</span> open_error';
    <span style="color: #859900; font-weight: bold;">end</span>

    open_mse_data(<span style="color: #268bd2; font-weight: bold;">i</span>)=trace(open_mse) <span style="color: #b58900;">/</span> N;
    open_empiricalmse_data(<span style="color: #268bd2; font-weight: bold;">i</span>) = trace(open_empiricalmse) <span style="color: #b58900;">/</span> N;
<span style="color: #859900; font-weight: bold;">end</span>

close(h);
<span style="color: #b58900;">figure</span>;
plot(rate,upper_mse_data, <span style="color: #2aa198;">'b-o'</span>,<span style="color: #2aa198;">'LineWidth'</span>,2);
hold on;
plot(rate,open_mse_data, <span style="color: #2aa198;">'k-'</span>,<span style="color: #2aa198;">'LineWidth'</span>,2);
hold on;
plot(rate,lower_mse_data, <span style="color: #2aa198;">'r-*'</span>,<span style="color: #2aa198;">'LineWidth'</span>,2);
hold on;
legend(<span style="color: #2aa198;">'Upper bound'</span>,<span style="color: #2aa198;">'Open-loop event-based schedule'</span>,<span style="color: #2aa198;">'Lower bound'</span>);
ylabel(<span style="color: #2aa198;">'$\lim_{k\rightarrow\infty}trace(\rm E[P_k^-])$'</span>,<span style="color: #2aa198;">'Interpreter'</span>,<span style="color: #2aa198;">'LaTex'</span>);
xlabel(<span style="color: #2aa198;">'\gamma'</span>);
<span style="color: #586e75;">%h = legend;</span>
<span style="color: #586e75;">%set(h, 'interpreter', 'latex');</span>
grid on;
filename = <span style="color: #2aa198;">'../../../public/tac-13-3.png'</span>;
print(<span style="color: #2aa198;">'-dpng'</span>, filename, <span style="color: #2aa198;">'-r100'</span>);
<span style="color: #268bd2; font-weight: bold;">ans</span> = filename <span style="color: #586e75;">% return the filename to org-mode</span>
</pre>
</div>


<div class="figure">
<p><img src="../../../public/tac-13-3.png" alt="tac-13-3.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-sec-2-3" class="outline-3">
<h3 id="sec-2-3">Fig 4</h3>
<div class="outline-text-3" id="text-2-3">
<div class="org-src-container">

<pre class="src src-matlab"><span style="color: #586e75;">% plot the upper bound, the lower bound and the empirical expected error of</span>
<span style="color: #586e75;">% covariance of the closed loop schedule</span>
close all;
clear all;

<span style="color: #586e75;">% parameter setting</span>
n = 2;
m = 1;
A = [1.001 1;0 0.95]; <span style="color: #586e75;">% generate an unstable A</span>
C = [1 1];
Q = eye(n);
sqrtQ = sqrtm(Q);
R = eye(m);
sqrtR = sqrtm(R);

N = 5000;
sample2=20;


<span style="color: #268bd2; font-weight: bold;">j</span>=0;
h = waitbar(0,<span style="color: #2aa198;">'please wait...'</span>);

Z_data = zeros(1,sample2);

<span style="color: #586e75;">% for </span><span style="color: #586e75;">i</span><span style="color: #586e75;">=</span><span style="color: #586e75; font-weight: bold;">1:sample2</span>
<span style="color: #586e75;">%     Z_data(i)=0.1+9.9*(i-1)/sample2; %generates uniform Z data points</span>
<span style="color: #586e75;">% end</span>
Z_data = 0.1<span style="color: #b58900;">*</span>[0.1 0.15 0.2 0.3 0.5 0.8 1.3 1.8 2.9 3.5 4.3 5.2 6.3 7.4 8.5 9.6 10.7 11.8 12.9 150];
rate=zeros(1,sample2);
close_empiricalrate_data = zeros(1,sample2);
close_empiricalmse_data = zeros(1,sample2);
close_mse_data=zeros(1,sample2);
upper_mse_data=zeros(1,sample2);
lower_mse_data=zeros(1,sample2);

<span style="color: #586e75; font-weight: bold; text-decoration: overline;">%% close-loop event-based MMSE under different rate</span>
<span style="color: #859900; font-weight: bold;">for</span> <span style="color: #268bd2;">i</span>=<span style="color: #268bd2; font-weight: bold;">1:sample2</span>

    <span style="color: #586e75;">%timer update</span>
    <span style="color: #268bd2; font-weight: bold;">j</span>=<span style="color: #268bd2; font-weight: bold;">j</span><span style="color: #b58900;">+</span>1;
    waitbar(<span style="color: #268bd2; font-weight: bold;">j</span><span style="color: #b58900;">/</span>sample2,h);

    x=zeros(n,N<span style="color: #b58900;">+</span>1);
    Sigma = eye(n);
    x(<span style="color: #b58900;">:</span>,1) = sqrtm(Sigma)<span style="color: #b58900;">*</span>randn(n,1);

    y=zeros(m,N<span style="color: #b58900;">+</span>1);


    close_empiricalmse = zeros(n); <span style="color: #586e75;">%average error*error'</span>
    close_mse = zeros(n); <span style="color: #586e75;">%average P_k</span>
    close_empiricalrate = 0; 


    hatx = zeros(n,1);
    P = Sigma;

    <span style="color: #859900; font-weight: bold;">for</span> <span style="color: #268bd2;">k</span>=<span style="color: #268bd2; font-weight: bold;">1:N  </span><span style="color: #586e75;">%linear dynamic system</span>
        x(<span style="color: #b58900;">:</span>,k<span style="color: #b58900;">+</span>1) = A <span style="color: #b58900;">*</span> x(<span style="color: #b58900;">:</span>,k) <span style="color: #b58900;">+</span> sqrtQ <span style="color: #b58900;">*</span> randn(n,1);
        y(<span style="color: #b58900;">:</span>,k) = C <span style="color: #b58900;">*</span> x(<span style="color: #b58900;">:</span>,k) <span style="color: #b58900;">+</span> sqrtR <span style="color: #b58900;">*</span> randn(m,1);
    <span style="color: #859900; font-weight: bold;">end</span>

    Z = Z_data(<span style="color: #268bd2; font-weight: bold;">i</span>); 
    invZ = 1<span style="color: #b58900;">/</span>Z;
    <span style="color: #859900; font-weight: bold;">for</span> <span style="color: #268bd2;">k</span> = <span style="color: #268bd2; font-weight: bold;">1:N</span>

        <span style="color: #586e75;">%uniform random variable</span>
        zeta = rand();
        threshold = exp(<span style="color: #b58900;">-</span>0.5<span style="color: #b58900;">*</span>(y(<span style="color: #b58900;">:</span>,k)<span style="color: #b58900;">-</span>C<span style="color: #b58900;">*</span>hatx)'<span style="color: #b58900;">*</span>(Z)<span style="color: #b58900;">*</span>(y(<span style="color: #b58900;">:</span>,k)<span style="color: #b58900;">-</span>C<span style="color: #b58900;">*</span>hatx));
        <span style="color: #859900; font-weight: bold;">if</span> zeta <span style="color: #b58900;">&lt;</span> threshold <span style="color: #586e75;">% not send y</span>
            F = P <span style="color: #b58900;">*</span> C' <span style="color: #b58900;">/</span> ( C<span style="color: #b58900;">*</span>P<span style="color: #b58900;">*</span>C' <span style="color: #b58900;">+</span> R <span style="color: #b58900;">+</span> invZ);
            hatx = hatx;
            P = P <span style="color: #b58900;">-</span> F<span style="color: #b58900;">*</span>C<span style="color: #b58900;">*</span>P;
        <span style="color: #859900; font-weight: bold;">else</span> <span style="color: #586e75;">% send y</span>
            L = P <span style="color: #b58900;">*</span> C' <span style="color: #b58900;">/</span> ( C<span style="color: #b58900;">*</span>P<span style="color: #b58900;">*</span>C' <span style="color: #b58900;">+</span> R);
            hatx = (eye(n) <span style="color: #b58900;">-</span> L<span style="color: #b58900;">*</span>C)<span style="color: #b58900;">*</span>hatx <span style="color: #b58900;">+</span> L<span style="color: #b58900;">*</span>y(<span style="color: #b58900;">:</span>,k);
            P = P <span style="color: #b58900;">-</span> L<span style="color: #b58900;">*</span>C<span style="color: #b58900;">*</span>P;
            close_empiricalrate = close_empiricalrate <span style="color: #b58900;">+</span> 1;
        <span style="color: #859900; font-weight: bold;">end</span>
        <span style="color: #586e75;">%prediction step</span>
        hatx = A <span style="color: #b58900;">*</span> hatx; 
        P = A <span style="color: #b58900;">*</span> P <span style="color: #b58900;">*</span> A' <span style="color: #b58900;">+</span> Q;

        close_mse = close_mse <span style="color: #b58900;">+</span> P;
        close_error = x(<span style="color: #b58900;">:</span>,k) <span style="color: #b58900;">-</span> hatx;
        close_empiricalmse = close_empiricalmse <span style="color: #b58900;">+</span> close_error <span style="color: #b58900;">*</span> close_error';
    <span style="color: #859900; font-weight: bold;">end</span>

    close_mse_data(<span style="color: #268bd2; font-weight: bold;">i</span>) = trace(close_mse) <span style="color: #b58900;">/</span> N;
    close_empiricalmse_data(<span style="color: #268bd2; font-weight: bold;">i</span>) = trace(close_empiricalmse) <span style="color: #b58900;">/</span> N;
    close_empiricalrate_data(<span style="color: #268bd2; font-weight: bold;">i</span>) = trace(close_empiricalrate) <span style="color: #b58900;">/</span> N;

    upper_mse = zeros(n); <span style="color: #586e75;">%average P_k    </span>
    hatx = zeros(n,1);
    P = Sigma;   
       <span style="color: #859900; font-weight: bold;">for</span> <span style="color: #268bd2;">k</span> = <span style="color: #268bd2; font-weight: bold;">1:N</span>


        L = P <span style="color: #b58900;">*</span> C' <span style="color: #b58900;">/</span> ( C<span style="color: #b58900;">*</span>P<span style="color: #b58900;">*</span>C' <span style="color: #b58900;">+</span> R <span style="color: #b58900;">+</span>1<span style="color: #b58900;">/</span>Z);
        hatx = (eye(n) <span style="color: #b58900;">-</span> L<span style="color: #b58900;">*</span>C)<span style="color: #b58900;">*</span>hatx <span style="color: #b58900;">+</span> L<span style="color: #b58900;">*</span>y(<span style="color: #b58900;">:</span>,k);
        P = P <span style="color: #b58900;">-</span> L<span style="color: #b58900;">*</span>C<span style="color: #b58900;">*</span>P;

       <span style="color: #586e75;">%prediction step</span>
        hatx = A <span style="color: #b58900;">*</span> hatx; 
        P = A <span style="color: #b58900;">*</span> P <span style="color: #b58900;">*</span> A' <span style="color: #b58900;">+</span> Q;

        upper_mse = upper_mse <span style="color: #b58900;">+</span> P;
       <span style="color: #859900; font-weight: bold;">end</span>

    upper_mse_data(<span style="color: #268bd2; font-weight: bold;">i</span>)=trace(upper_mse) <span style="color: #b58900;">/</span> N;

    upper_gamma= 1<span style="color: #b58900;">-</span>1<span style="color: #b58900;">/</span>sqrt(1<span style="color: #b58900;">+</span>(C<span style="color: #b58900;">*</span>upper_mse<span style="color: #b58900;">*</span>C'<span style="color: #b58900;">/</span>N<span style="color: #b58900;">+</span>R)<span style="color: #b58900;">*</span>Z);
    <span style="color: #586e75;">%upper_gamma= 1-1/sqrt(1+(C*C*0.5781+R)*Z);</span>
    lower_mse = zeros(n); <span style="color: #586e75;">%average P_k</span>
    Sigma = eye(n);

    hatx = zeros(n,1);
    P = Sigma;   
       <span style="color: #859900; font-weight: bold;">for</span> <span style="color: #268bd2;">k</span> = <span style="color: #268bd2; font-weight: bold;">1:N</span>

        L = P <span style="color: #b58900;">*</span> C' <span style="color: #b58900;">/</span> ( C<span style="color: #b58900;">*</span>P<span style="color: #b58900;">*</span>C' <span style="color: #b58900;">+</span> 1<span style="color: #b58900;">/</span>(upper_gamma<span style="color: #b58900;">/</span>R <span style="color: #b58900;">+</span> (1<span style="color: #b58900;">-</span>upper_gamma)<span style="color: #b58900;">/</span>(R<span style="color: #b58900;">+</span>1<span style="color: #b58900;">/</span>Z)) );
        <span style="color: #586e75;">%L = P * C' / ( C*P*C' + R );</span>
        hatx = (eye(n) <span style="color: #b58900;">-</span> L<span style="color: #b58900;">*</span>C)<span style="color: #b58900;">*</span>hatx <span style="color: #b58900;">+</span> L<span style="color: #b58900;">*</span>y(<span style="color: #b58900;">:</span>,k);
        P = P <span style="color: #b58900;">-</span> L<span style="color: #b58900;">*</span>C<span style="color: #b58900;">*</span>P;

        <span style="color: #586e75;">%prediction step</span>
        hatx = A <span style="color: #b58900;">*</span> hatx; 
        P = A <span style="color: #b58900;">*</span> P <span style="color: #b58900;">*</span> A' <span style="color: #b58900;">+</span> Q;

        lower_mse =lower_mse <span style="color: #b58900;">+</span> P;
       <span style="color: #859900; font-weight: bold;">end</span>
    lower_mse_data(<span style="color: #268bd2; font-weight: bold;">i</span>)=trace(lower_mse) <span style="color: #b58900;">/</span> N;
<span style="color: #859900; font-weight: bold;">end</span>

close(h);
<span style="color: #b58900;">figure</span>;
plot(close_empiricalrate_data,upper_mse_data, <span style="color: #2aa198;">'b-o'</span>,<span style="color: #2aa198;">'LineWidth'</span>,2);
hold on;
plot(close_empiricalrate_data,close_mse_data, <span style="color: #2aa198;">'k-'</span>,<span style="color: #2aa198;">'LineWidth'</span>,2);
hold on;
plot(close_empiricalrate_data,lower_mse_data, <span style="color: #2aa198;">'r-*'</span>,<span style="color: #2aa198;">'LineWidth'</span>,2);

legend(<span style="color: #2aa198;">'Upper bound'</span>,<span style="color: #2aa198;">'Closed-loop event-based schedule'</span>,<span style="color: #2aa198;">'Lower bound'</span>);
ylabel(<span style="color: #2aa198;">'$\lim_{k\rightarrow\infty}trace(\rm E[P_k^-])$'</span>,<span style="color: #2aa198;">'Interpreter'</span>,<span style="color: #2aa198;">'LaTex'</span>);
xlabel(<span style="color: #2aa198;">'\gamma'</span>);
<span style="color: #586e75;">%h = legend;</span>
<span style="color: #586e75;">%set(h, 'interpreter', 'latex');</span>
grid on;
filename = <span style="color: #2aa198;">'../../../public/tac-13-4.png'</span>;
print(<span style="color: #2aa198;">'-dpng'</span>, filename, <span style="color: #2aa198;">'-r100'</span>);
<span style="color: #268bd2; font-weight: bold;">ans</span> = filename <span style="color: #586e75;">% return the filename to org-mode</span>
</pre>
</div>


<div class="figure">
<p><img src="../../../public/tac-13-4.png" alt="tac-13-4.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-sec-2-4" class="outline-3">
<h3 id="sec-2-4">Fig 5</h3>
<div class="outline-text-3" id="text-2-4">
<div class="org-src-container">

<pre class="src src-matlab">m = 2; n = 2;
A=[0.8 1;0 0.95];
C=[0.5 0.3; 0 1.4];
Q = eye(n);
inQ = inv(Q);
R = eye(n); 
inR = inv(R);
L = chol(R);
I = eye(n);

subrate=zeros(1,50);
kappa=zeros(1,50);
lbound=zeros(1,50);

[XX,YY,ZZ]=dare(A',C',Q,R,zeros(n),eye(n));

<span style="color: #859900; font-weight: bold;">for</span> <span style="color: #268bd2;">i</span>=<span style="color: #268bd2; font-weight: bold;">3:50</span>
    Delta=XX<span style="color: #b58900;">+</span>0.02<span style="color: #b58900;">*</span><span style="color: #268bd2; font-weight: bold;">i</span><span style="color: #b58900;">*</span>eye(n);
    invDelta=inv(Delta);

    Px = dlyap(A,Q);      <span style="color: #586e75;">%asymptotic covariance of x</span>
    Pi = C <span style="color: #b58900;">*</span> Px <span style="color: #b58900;">*</span> C' <span style="color: #b58900;">+</span> R; <span style="color: #586e75;">%asymptotic covariance of y</span>

    PU = chol(Pi);
    lgPi = log(det(Pi));
    lginvR = log(det(inv(R)));
    invPi = inv(Pi);

    <span style="color: #586e75;">%constant = log((1-rate)^(-2))-lginvR-lginvR;</span>
    cvx_begin sdp
    variable Y(n,n) symmetric
    variable M1(n,n) symmetric
    variable M2(n,n) symmetric
    variable S(n,n) symmetric
    minimize( trace(Pi<span style="color: #b58900;">*</span>Y) )
    subject to
        [A'<span style="color: #b58900;">*</span>inQ<span style="color: #b58900;">*</span>A<span style="color: #b58900;">+</span>C'<span style="color: #b58900;">*</span>inR<span style="color: #b58900;">*</span>C<span style="color: #b58900;">+</span>S A'<span style="color: #b58900;">*</span>inQ C'<span style="color: #b58900;">*</span>inR;
            inQ<span style="color: #b58900;">*</span>A inQ<span style="color: #b58900;">-</span>S zeros(n,m);
            inR<span style="color: #b58900;">*</span>C zeros(m,n) Y<span style="color: #b58900;">+</span>inR]<span style="color: #b58900;">&gt;=</span>0
        [S eye(n);
            eye(n) Delta]<span style="color: #b58900;">&gt;=</span>0
        Y<span style="color: #b58900;">&gt;=</span>0
        <span style="color: #b58900;">-</span>S <span style="color: #b58900;">&gt;=</span> <span style="color: #b58900;">-</span>inQ
    cvx_end
    kappa(<span style="color: #268bd2; font-weight: bold;">i</span>)=1<span style="color: #b58900;">/</span>sqrt(1<span style="color: #b58900;">+</span>trace(Pi<span style="color: #b58900;">*</span>Y))<span style="color: #b58900;">-</span>1<span style="color: #b58900;">/</span>sqrt(det(eye(n)<span style="color: #b58900;">+</span>Pi<span style="color: #b58900;">*</span>Y));
    lbound(<span style="color: #268bd2; font-weight: bold;">i</span>)=1<span style="color: #b58900;">-</span>1<span style="color: #b58900;">/</span>sqrt(1<span style="color: #b58900;">+</span>trace(Pi<span style="color: #b58900;">*</span>Y));
    subrate(<span style="color: #268bd2; font-weight: bold;">i</span>)=1<span style="color: #b58900;">-</span>1<span style="color: #b58900;">/</span>sqrt(det(eye(n)<span style="color: #b58900;">+</span>Pi<span style="color: #b58900;">*</span>Y));
<span style="color: #859900; font-weight: bold;">end</span>

plot(0.02<span style="color: #b58900;">*</span>(3<span style="color: #b58900;">:</span>2<span style="color: #b58900;">:</span>50),subrate(1,3<span style="color: #b58900;">:</span>2<span style="color: #b58900;">:</span>50),<span style="color: #2aa198;">'b-O'</span>,<span style="color: #2aa198;">'linewidth'</span>,1.5);
hold on
plot(0.02<span style="color: #b58900;">*</span>(3<span style="color: #b58900;">:</span>50),lbound(1,3<span style="color: #b58900;">:</span>50),<span style="color: #2aa198;">'r-'</span>,<span style="color: #2aa198;">'linewidth'</span>,1.5)
xlabel(<span style="color: #2aa198;">'\varpi'</span>);
legend(<span style="color: #2aa198;">'Suboptimal \gamma^{Y^*}'</span>,<span style="color: #2aa198;">'Lower bound of \gamma^{opt}'</span>)

filename = <span style="color: #2aa198;">'../../../public/tac-13-5.png'</span>;
print(<span style="color: #2aa198;">'-dpng'</span>, filename, <span style="color: #2aa198;">'-r100'</span>);
<span style="color: #268bd2; font-weight: bold;">ans</span> = filename <span style="color: #586e75;">% return the filename to org-mode</span>
</pre>
</div>


<div class="figure">
<p><img src="../../../public/tac-13-5.png" alt="tac-13-5.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-sec-2-5" class="outline-3">
<h3 id="sec-2-5">Fig 6 and 7</h3>
<div class="outline-text-3" id="text-2-5">
<div class="org-src-container">

<pre class="src src-matlab"><span style="color: #586e75;">% Compare the closed-loop event-based schedule with the deterministic schedule proposed by Keyou You and Lihua Xie in [26]</span>

<span style="color: #586e75;">% parameter setting</span>
T = 1;
alpha = 0.01;
var_acceleration = 5;

n = 3;
A = [1 T T<span style="color: #b58900;">^</span>2;0 1 T; 0 0 1]; <span style="color: #586e75;">% generate a stable A</span>
m = 3;
C = eye(m);

Q = 2<span style="color: #b58900;">*</span>alpha<span style="color: #b58900;">*</span>var_acceleration<span style="color: #b58900;">*</span>[(T<span style="color: #b58900;">^</span>5)<span style="color: #b58900;">/</span>20 (T<span style="color: #b58900;">^</span>4)<span style="color: #b58900;">/</span>8 (T<span style="color: #b58900;">^</span>3)<span style="color: #b58900;">/</span>6;(T<span style="color: #b58900;">^</span>4)<span style="color: #b58900;">/</span>8 (T<span style="color: #b58900;">^</span>3)<span style="color: #b58900;">/</span>3 (T<span style="color: #b58900;">^</span>2)<span style="color: #b58900;">/</span>2; (T<span style="color: #b58900;">^</span>3)<span style="color: #b58900;">/</span>6 (T<span style="color: #b58900;">^</span>2)<span style="color: #b58900;">/</span>2 T];
sqrtQ = sqrtm(Q);
R = 1<span style="color: #b58900;">*</span>eye(m);
sqrtR = sqrtm(R);

<span style="color: #586e75;">%Z_data = 0.047*eye(m); %smaller Z, smaller rate ///for </span><span style="color: #586e75;">C</span><span style="color: #586e75;"> = </span><span style="color: #586e75; font-weight: bold;">eye(3)</span>
<span style="color: #586e75;">%delta_data = [4.30]; %smaller delta, larger rate///for </span><span style="color: #586e75;">C</span><span style="color: #586e75;"> = </span><span style="color: #586e75; font-weight: bold;">eye(3)</span>
Z_data = 0.52<span style="color: #b58900;">*</span>eye(m); <span style="color: #586e75;">%smaller Z, smaller rate ///for </span><span style="color: #586e75;">C</span><span style="color: #586e75;"> = </span><span style="color: #586e75; font-weight: bold;">eye(3)</span>
delta_data = [1.6]; <span style="color: #586e75;">%smaller delta, larger rate///for </span><span style="color: #586e75;">C</span><span style="color: #586e75;"> = </span><span style="color: #586e75; font-weight: bold;">eye(3)</span>

N = 100;
sample2=1;
countermax=5000;


<span style="color: #268bd2; font-weight: bold;">j</span>=0;
h = waitbar(0,<span style="color: #2aa198;">'please wait...'</span>);


<span style="color: #586e75;">% for </span><span style="color: #586e75;">i</span><span style="color: #586e75;">=</span><span style="color: #586e75; font-weight: bold;">1:sample2</span>
<span style="color: #586e75;">%     Z_data(i)=0.1+9.9*(i-1)/sample2; %generates uniform Z data points</span>
<span style="color: #586e75;">% end</span>

rate=zeros(1,sample2);
close_empiricalrate_data = zeros(1,sample2);
close_empiricalmse_data = zeros(1,sample2);
close_mse_data=zeros(1,sample2);
close_hatx_data=zeros(n,N<span style="color: #b58900;">+</span>1);
close_P_data=zeros(1,N);
close_empiricalP_data=zeros(1,N);

keyou_empiricalrate_data = zeros(1,sample2);
keyou_empiricalmse_data = zeros(1,sample2);
keyou_mse_data=zeros(1,sample2);
keyou_hatx_data=zeros(n,N<span style="color: #b58900;">+</span>1);
keyou_P_data=zeros(1,N);
keyou_empiricalP_data=zeros(1,N);

Sigma = 0.1<span style="color: #b58900;">*</span>[1 1<span style="color: #b58900;">/</span>T 0;1<span style="color: #b58900;">/</span>T 2<span style="color: #b58900;">/</span>(T<span style="color: #b58900;">^</span>2) 0; 0 0 0.00001];

<span style="color: #586e75; font-weight: bold; text-decoration: overline;">%% close-loop event-based MMSE under different rate</span>
<span style="color: #859900; font-weight: bold;">for</span> <span style="color: #268bd2;">counter</span>=<span style="color: #268bd2; font-weight: bold;">1:countermax</span>
        <span style="color: #586e75;">% timer update</span>
        <span style="color: #268bd2; font-weight: bold;">j</span>=<span style="color: #268bd2; font-weight: bold;">j</span><span style="color: #b58900;">+</span>1;
        waitbar(<span style="color: #268bd2; font-weight: bold;">j</span><span style="color: #b58900;">/</span>countermax,h);

        x(<span style="color: #b58900;">:</span>,1) = sqrtm(Sigma)<span style="color: #b58900;">*</span>randn(n,1);

        <span style="color: #586e75;">% generate linear dynamic system</span>
        x=zeros(n,N<span style="color: #b58900;">+</span>1);
        y=zeros(m,N<span style="color: #b58900;">+</span>1);

        <span style="color: #859900; font-weight: bold;">for</span> <span style="color: #268bd2;">k</span>=<span style="color: #268bd2; font-weight: bold;">1:N </span>
            x(<span style="color: #b58900;">:</span>,k<span style="color: #b58900;">+</span>1) = A <span style="color: #b58900;">*</span> x(<span style="color: #b58900;">:</span>,k) <span style="color: #b58900;">+</span> sqrtQ <span style="color: #b58900;">*</span> randn(n,1);
            y(<span style="color: #b58900;">:</span>,k) = C <span style="color: #b58900;">*</span> x(<span style="color: #b58900;">:</span>,k) <span style="color: #b58900;">+</span> sqrtR <span style="color: #b58900;">*</span> randn(m,1);
        <span style="color: #859900; font-weight: bold;">end</span>

        hatx = zeros(n,1);
        P = Sigma;

        close_empiricalmse = zeros(n); <span style="color: #586e75;">%average error*error'</span>
        close_mse = zeros(n); <span style="color: #586e75;">%average P_k</span>
        close_empiricalrate = 0; 

      <span style="color: #586e75; font-weight: bold; text-decoration: overline;">%%%%%%%%%%% proposed closed loop scheduler    %%%%%%%%%%%%%%%%%%%%%%%%%</span>
        Z = Z_data; 
        invZ = inv(Z);

        <span style="color: #859900; font-weight: bold;">for</span> <span style="color: #268bd2;">k</span> = <span style="color: #268bd2; font-weight: bold;">1:N</span>

            <span style="color: #586e75;">%prediction step</span>
            hatx = A <span style="color: #b58900;">*</span> hatx; 
            P = A <span style="color: #b58900;">*</span> P <span style="color: #b58900;">*</span> A' <span style="color: #b58900;">+</span> Q;

            <span style="color: #586e75;">%generate a uniform random variable</span>
            zeta = rand();
            threshold = exp(<span style="color: #b58900;">-</span>0.5<span style="color: #b58900;">*</span>(y(<span style="color: #b58900;">:</span>,k)<span style="color: #b58900;">-</span>C<span style="color: #b58900;">*</span>hatx)'<span style="color: #b58900;">*</span>(Z)<span style="color: #b58900;">*</span>(y(<span style="color: #b58900;">:</span>,k)<span style="color: #b58900;">-</span>C<span style="color: #b58900;">*</span>hatx));
            <span style="color: #859900; font-weight: bold;">if</span> zeta <span style="color: #b58900;">&lt;</span> threshold <span style="color: #586e75;">% not send y</span>
                F = P <span style="color: #b58900;">*</span> C' <span style="color: #b58900;">/</span> ( C<span style="color: #b58900;">*</span>P<span style="color: #b58900;">*</span>C' <span style="color: #b58900;">+</span> R <span style="color: #b58900;">+</span> invZ);
                hatx = hatx;
                P = P <span style="color: #b58900;">-</span> F<span style="color: #b58900;">*</span>C<span style="color: #b58900;">*</span>P;
            <span style="color: #859900; font-weight: bold;">else</span> <span style="color: #586e75;">% send y</span>
                L = P <span style="color: #b58900;">*</span> C' <span style="color: #b58900;">/</span> ( C<span style="color: #b58900;">*</span>P<span style="color: #b58900;">*</span>C' <span style="color: #b58900;">+</span> R);
                hatx = (eye(n) <span style="color: #b58900;">-</span> L<span style="color: #b58900;">*</span>C)<span style="color: #b58900;">*</span>hatx <span style="color: #b58900;">+</span> L<span style="color: #b58900;">*</span>y(<span style="color: #b58900;">:</span>,k);
                P = P <span style="color: #b58900;">-</span> L<span style="color: #b58900;">*</span>C<span style="color: #b58900;">*</span>P;
                close_empiricalrate = close_empiricalrate <span style="color: #b58900;">+</span> 1;
            <span style="color: #859900; font-weight: bold;">end</span>

            close_mse = close_mse <span style="color: #b58900;">+</span> P;
            close_error = x(<span style="color: #b58900;">:</span>,k) <span style="color: #b58900;">-</span> hatx; 
                <span style="color: #586e75;">%close_P_data(:,k) = close_P_data(:,k) + trace(P);</span>
            close_P_data(<span style="color: #b58900;">:</span>,k) = close_P_data(<span style="color: #b58900;">:</span>,k) <span style="color: #b58900;">+</span> P(1,1);
            temp1 = close_error <span style="color: #b58900;">*</span> close_error';
            close_empiricalP_data(<span style="color: #b58900;">:</span>,k) = close_empiricalP_data(<span style="color: #b58900;">:</span>,k) <span style="color: #b58900;">+</span> temp1(1,1);
                <span style="color: #586e75;">%close_empiricalP_data(:,k) = close_empiricalP_data(:,k) + trace(temp1);</span>

        <span style="color: #859900; font-weight: bold;">end</span>

        <span style="color: #586e75;">%close_mse_data = close_mse(1,1) / N;</span>
        close_mse_data = trace(close_mse) <span style="color: #b58900;">/</span> N;
        <span style="color: #586e75;">%close_empiricalmse_data = close_empiricalmse_data(i)+close_empiricalmse(1,1) / N;</span>
        close_empiricalmse_data = close_empiricalmse_data<span style="color: #b58900;">+</span>trace(close_empiricalmse) <span style="color: #b58900;">/</span> N;
        <span style="color: #586e75;">%close_empiricalrate_data = close_empiricalrate_data + close_empiricalrate(1,1) / N;</span>
        close_empiricalrate_data = close_empiricalrate_data <span style="color: #b58900;">+</span> trace(close_empiricalrate) <span style="color: #b58900;">/</span> N;

        <span style="color: #586e75; font-weight: bold; text-decoration: overline;">%%%%%%%%% keyou's scheduler %%%%%%%%%%%%%%%%%%%%%</span>
        hatx = zeros(n,1);
        P = Sigma;

        keyou_empiricalmse = zeros(n); <span style="color: #586e75;">%average error*error'</span>
        keyou_mse = zeros(n); <span style="color: #586e75;">%average P_k</span>
        keyou_empiricalrate = 0; 

        delta = delta_data; 

        <span style="color: #859900; font-weight: bold;">for</span> <span style="color: #268bd2;">k</span> = <span style="color: #268bd2; font-weight: bold;">1:N</span>

            <span style="color: #586e75;">%prediction step</span>
            hatx = A <span style="color: #b58900;">*</span> hatx; 
            P = A <span style="color: #b58900;">*</span> P <span style="color: #b58900;">*</span> A' <span style="color: #b58900;">+</span> Q;

            zk = inv(sqrt(C<span style="color: #b58900;">*</span>P<span style="color: #b58900;">*</span>C'<span style="color: #b58900;">+</span>R))<span style="color: #b58900;">*</span>(y(<span style="color: #b58900;">:</span>,k)<span style="color: #b58900;">-</span>C<span style="color: #b58900;">*</span>hatx);
            <span style="color: #859900; font-weight: bold;">if</span> abs(zk) <span style="color: #b58900;">&lt;</span> delta <span style="color: #586e75;">% not send y</span>
                L = P <span style="color: #b58900;">*</span> C' <span style="color: #b58900;">/</span> ( C<span style="color: #b58900;">*</span>P<span style="color: #b58900;">*</span>C' <span style="color: #b58900;">+</span> R);
                hatx = hatx;
                hx = sqrt(2<span style="color: #b58900;">/</span><span style="color: #268bd2; font-weight: bold;">pi</span>)<span style="color: #b58900;">*</span>delta<span style="color: #b58900;">*</span>exp(<span style="color: #b58900;">-</span>(delta<span style="color: #b58900;">^</span>2)<span style="color: #b58900;">/</span>2)<span style="color: #b58900;">/</span>(1<span style="color: #b58900;">-</span>erfc(delta<span style="color: #b58900;">/</span>sqrt(2)));
                P = P <span style="color: #b58900;">-</span> hx<span style="color: #b58900;">*</span>L<span style="color: #b58900;">*</span>C<span style="color: #b58900;">*</span>P;
            <span style="color: #859900; font-weight: bold;">else</span> <span style="color: #586e75;">% send y</span>
                L = P <span style="color: #b58900;">*</span> C' <span style="color: #b58900;">/</span> ( C<span style="color: #b58900;">*</span>P<span style="color: #b58900;">*</span>C' <span style="color: #b58900;">+</span> R);
                hatx = (eye(n) <span style="color: #b58900;">-</span> L<span style="color: #b58900;">*</span>C)<span style="color: #b58900;">*</span>hatx <span style="color: #b58900;">+</span> L<span style="color: #b58900;">*</span>y(<span style="color: #b58900;">:</span>,k);
                P = P <span style="color: #b58900;">-</span> L<span style="color: #b58900;">*</span>C<span style="color: #b58900;">*</span>P;
                keyou_empiricalrate = keyou_empiricalrate <span style="color: #b58900;">+</span> 1;
            <span style="color: #859900; font-weight: bold;">end</span>

            keyou_mse = keyou_mse <span style="color: #b58900;">+</span> P;
            keyou_error = x(<span style="color: #b58900;">:</span>,k) <span style="color: #b58900;">-</span> hatx;
            keyou_empiricalmse = keyou_empiricalmse <span style="color: #b58900;">+</span> keyou_error <span style="color: #b58900;">*</span> keyou_error';

            keyou_hatx_data(<span style="color: #b58900;">:</span>,k) = hatx;
            keyou_P_data(<span style="color: #b58900;">:</span>,k) = keyou_P_data(<span style="color: #b58900;">:</span>,k) <span style="color: #b58900;">+</span> P(1,1);
               <span style="color: #586e75;">%keyou_P_data(:,k) = keyou_P_data(:,k) + trace(P);</span>
            temp2 = keyou_error <span style="color: #b58900;">*</span> keyou_error';
            keyou_empiricalP_data(<span style="color: #b58900;">:</span>,k) = keyou_empiricalP_data(<span style="color: #b58900;">:</span>,k) <span style="color: #b58900;">+</span> temp2(1,1);  
                <span style="color: #586e75;">%keyou_empiricalP_data(:,k) = keyou_empiricalP_data(:,k) + trace(temp2);</span>

        <span style="color: #859900; font-weight: bold;">end</span>

        <span style="color: #586e75;">%keyou_mse_data(i) = keyou_mse(1,1) / N;</span>
        keyou_mse_data = trace(keyou_mse) <span style="color: #b58900;">/</span> N;
        <span style="color: #586e75;">%keyou_empiricalmse_data(i) = keyou_empiricalmse_data(i)+ keyou_empiricalmse(1,1) / N;</span>
        keyou_empiricalmse_data = keyou_empiricalmse_data<span style="color: #b58900;">+</span> trace(keyou_empiricalmse) <span style="color: #b58900;">/</span> N;
        <span style="color: #586e75;">%keyou_empiricalrate_data = keyou_empiricalrate_data + keyou_empiricalrate(1,1)/ N;</span>
        keyou_empiricalrate_data = keyou_empiricalrate_data <span style="color: #b58900;">+</span> trace(keyou_empiricalrate)<span style="color: #b58900;">/</span> N;
<span style="color: #859900; font-weight: bold;">end</span>

close_P_data = close_P_data<span style="color: #b58900;">/</span>countermax;
close_empiricalP_data = close_empiricalP_data<span style="color: #b58900;">/</span>countermax;
close_empiricalrate_data= close_empiricalrate_data<span style="color: #b58900;">/</span>countermax;
keyou_P_data = keyou_P_data<span style="color: #b58900;">/</span>countermax;
keyou_empiricalP_data = keyou_empiricalP_data<span style="color: #b58900;">/</span>countermax;
keyou_empiricalrate_data = keyou_empiricalrate_data<span style="color: #b58900;">/</span>countermax;


Keyou_rate=keyou_empiricalrate_data
Mine_rate=close_empiricalrate_data
close(h);
<span style="color: #b58900;">figure</span>;
subplot(1,2,1);
plot(1<span style="color: #b58900;">:</span>N,close_empiricalP_data, <span style="color: #2aa198;">'b-.'</span>,<span style="color: #2aa198;">'LineWidth'</span>,2);
hold on;
plot(1<span style="color: #b58900;">:</span>N,close_P_data, <span style="color: #2aa198;">'k-'</span>,<span style="color: #2aa198;">'LineWidth'</span>,2);
title(<span style="color: #2aa198;">'CLSET-KF'</span>);
legend(<span style="color: #2aa198;">'Empirical P_{11}'</span>,<span style="color: #2aa198;">'Theoretical P_{11}'</span>);
xlabel(<span style="color: #2aa198;">'Time'</span>);
<span style="color: #b58900;">axis</span>([0 N 0 1.5]); <span style="color: #586e75;">% for high rate</span>
<span style="color: #586e75;">%axis([0 N 0 30]); % for low rate</span>
grid on;
subplot(1,2,2);
plot(1<span style="color: #b58900;">:</span>N,keyou_empiricalP_data, <span style="color: #2aa198;">'b-.'</span>,<span style="color: #2aa198;">'LineWidth'</span>,2);
hold on;
plot(1<span style="color: #b58900;">:</span>N,keyou_P_data, <span style="color: #2aa198;">'k-'</span>,<span style="color: #2aa198;">'LineWidth'</span>,2);
title(<span style="color: #2aa198;">'DET-KF'</span>);
legend(<span style="color: #2aa198;">'Empirical P_{11}'</span>,<span style="color: #2aa198;">'Theoretical P_{11}'</span>);
xlabel(<span style="color: #2aa198;">'Time'</span>);
<span style="color: #b58900;">axis</span>([0 N 0 1.5]);<span style="color: #586e75;">% for high rate</span>
<span style="color: #586e75;">%axis([0 N 0 30]);% for low rate</span>
grid on;

filename = <span style="color: #2aa198;">'../../../public/tac-13-6.png'</span>;
print(<span style="color: #2aa198;">'-dpng'</span>, filename, <span style="color: #2aa198;">'-r100'</span>);
<span style="color: #268bd2; font-weight: bold;">ans</span> = filename <span style="color: #586e75;">% return the filename to org-mode</span>
</pre>
</div>


<div class="figure">
<p><img src="../../../public/tac-13-6.png" alt="tac-13-6.png" />
</p>
</div>
</div>
</div>
</div>
